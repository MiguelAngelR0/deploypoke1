"use strict";(self.webpackChunkpokeProyec=self.webpackChunkpokeProyec||[]).push([[861],{557:(G,h,c)=>{c.r(h),c.d(h,{BattlePokePageModule:()=>O});var l=c(6895),t=c(4650),k=c(5861);class f{constructor(o,e,a){this.nombre=o,this.ataques=e,this.stats=a}}class x{constructor(o,e,a,s,i,r){this.hp=o,this.attack=e,this.defense=a,this.specialAttack=s,this.specialDefense=i,this.speed=r}}var B=c(414),m=c(9299),y=c(1997),v=c(7392),g=c(4859);const P=function(n){return{"background-color":n}};function Z(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2),t.qZA(),t._uU(3),t.TgZ(4,"div",12),t._UZ(5,"div",13),t.qZA(),t.BQk()),2&n){const e=t.oxw(3);t.xp6(2),t.Oqu(e.pokemonBattle.nombre),t.xp6(1),t.hij(" ",e.pokemonBattle.stats.hp," "),t.xp6(2),t.Udp("width",e.calcularPorcentajeVida(e.pokemonBattle.stats.hp)),t.Q6J("ngStyle",t.VKq(5,P,e.pokemonBattle.stats.hp<=.3*e.MAX_HP?"red":"#4caf50"))}}function A(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2),t.qZA(),t._uU(3),t.TgZ(4,"div",12),t._UZ(5,"div",13),t.qZA(),t.BQk()),2&n){const e=t.oxw(3);t.xp6(2),t.Oqu(e.pokemonBattleEnemy.nombre),t.xp6(1),t.hij(" ",e.pokemonBattleEnemy.stats.hp," "),t.xp6(2),t.Udp("width",e.calcularPorcentajeVidaE(e.pokemonBattleEnemy.stats.hp)),t.Q6J("ngStyle",t.VKq(5,P,e.pokemonBattleEnemy.stats.hp<=.3*e.MAX_HP?"red":"#4caf50"))}}function q(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",14),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(3);return t.KtG(s.volver())}),t.TgZ(2,"mat-icon"),t._uU(3,"arrow_back"),t.qZA()(),t.BQk()}}function E(n,o){1&n&&t.GkF(0)}function b(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",17),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2).$implicit,i=t.oxw(4);return t.KtG(i.atacar(s))}),t.TgZ(1,"h5"),t._uU(2),t.qZA(),t.TgZ(3,"p"),t._uU(4),t.qZA(),t.TgZ(5,"p"),t._uU(6),t.qZA(),t.TgZ(7,"p"),t._uU(8),t.qZA()()}if(2&n){const e=t.oxw(2).$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(2),t.hij("Poder: ",e.power," "),t.xp6(2),t.hij("PP: ",e.pp," "),t.xp6(2),t.hij("Acuarancy: ",e.accuracy,"")}}function T(n,o){if(1&n&&(t.ynx(0),t.YNc(1,b,9,4,"button",16),t.BQk()),2&n){const e=t.oxw().index;t.xp6(1),t.Q6J("ngIf",e<4)}}function F(n,o){if(1&n&&(t.ynx(0),t.YNc(1,T,2,1,"ng-container",7),t.BQk()),2&n){const e=t.oxw(4);t.xp6(1),t.Q6J("ngIf",e.mostrarAtaques)}}function C(n,o){if(1&n&&(t.ynx(0),t.YNc(1,F,2,1,"ng-container",15),t.BQk()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",null==e.pokemonBattle?null:e.pokemonBattle.ataques)}}function w(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",18)(2,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(3);return t.KtG(s.realizarBatalla())}),t._uU(3,"Atacar"),t.qZA(),t.TgZ(4,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(3);return t.KtG(s.usarPocion())}),t._uU(5,"Usar Poci\xf3n"),t.qZA()(),t.TgZ(6,"div",18)(7,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(3);return t.KtG(s.huir())}),t._uU(8,"Huir"),t.qZA(),t.TgZ(9,"button",20),t._uU(10,"Detalles"),t.qZA()(),t.BQk()}}function M(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",4)(2,"div",5),t._UZ(3,"img",6),t.YNc(4,Z,6,7,"ng-container",7),t.qZA(),t.TgZ(5,"div",5),t._UZ(6,"img",8),t.YNc(7,A,6,7,"ng-container",7),t.qZA()(),t.TgZ(8,"div",4)(9,"div",9),t.YNc(10,q,4,0,"ng-container",7),t.qZA()(),t.TgZ(11,"div",4),t.YNc(12,E,1,0,"ng-container",7),t.TgZ(13,"div",10)(14,"div")(15,"h5"),t._uU(16,"Ataques:"),t.qZA(),t.TgZ(17,"p"),t._uU(18),t.qZA()(),t.TgZ(19,"div")(20,"h5"),t._uU(21,"Ataques del enemigo:"),t.qZA(),t.TgZ(22,"p"),t._uU(23),t.qZA()()()(),t.TgZ(24,"div",4)(25,"div",11),t.YNc(26,C,2,1,"ng-container",7),t.qZA()(),t.TgZ(27,"div",4),t.YNc(28,w,11,0,"ng-container",7),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(3),t.s9C("src",e.pokemon.sprites.back_default,t.LSH),t.xp6(1),t.Q6J("ngIf",e.pokemonBattle),t.xp6(2),t.Q6J("src",e.pokemonE.sprites.front_default,t.LSH),t.xp6(1),t.Q6J("ngIf",e.pokemonBattleEnemy),t.xp6(3),t.Q6J("ngIf",e.mostrarAtaques),t.xp6(8),t.Oqu(e.mensajeAtaque),t.xp6(5),t.Oqu(e.mensajeAtaqueEnemigo),t.xp6(3),t.Q6J("ngIf",e.pokemonBattleEnemy),t.xp6(2),t.Q6J("ngIf",!e.mostrarAtaques)}}function U(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"h1"),t._uU(2,"Perdiste"),t.qZA(),t.TgZ(3,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(3);return t.KtG(s.huir())}),t._uU(4,"Volver a las batallas pokemons"),t.qZA(),t.BQk()}}function j(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"h1"),t._uU(1,"Ganaste"),t.qZA(),t.TgZ(2,"button",19),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(3);return t.KtG(s.huir())}),t._uU(3,"Volver a las batallas pokemons"),t.qZA()}}function J(n,o){if(1&n&&(t.YNc(0,U,5,0,"ng-container",0),t.YNc(1,j,4,0,"ng-template",null,21,t.W1O)),2&n){const e=t.MAs(2),a=t.oxw(2);t.Q6J("ngIf",a.pokemonBattle.stats.hp<=0)("ngIfElse",e)}}function I(n,o){if(1&n&&(t.TgZ(0,"div")(1,"div",2),t.YNc(2,M,29,9,"ng-container",0),t.YNc(3,J,3,2,"ng-template",null,3,t.W1O),t.qZA()()),2&n){const e=t.MAs(4),a=t.oxw();t.xp6(2),t.Q6J("ngIf",a.pokemonBattle.stats.hp>0&&a.pokemonBattleEnemy.stats.hp>0)("ngIfElse",e)}}function N(n,o){1&n&&(t.TgZ(0,"h1"),t._uU(1,"Cargando..."),t.qZA())}let H=(()=>{class n{constructor(e,a,s,i){this.pokemonService=e,this.activatedRouter=a,this.router=s,this.authService=i,this.id=19,this.idE=3,this.modo="",this.ataques=[],this.ataquesE=[],this.mostrarAtaques=!1,this.mostrarPociones=!1,this.mensajeAtaque="",this.mensajeAtaqueEnemigo=""}ngOnInit(){var e=this;const a=sessionStorage.getItem("user");this.user=JSON.parse(a??""),console.log("hay usuario",this.user),this.activatedRouter.params.subscribe(function(){var s=(0,k.Z)(function*(i){e.id=i.id,e.idE=i.idE,e.modo=i.modo,e.pokemon=yield e.pokemonService.getById(e.id),e.MAX_HP=e.pokemon.stats[0].base_stat,e.pokemonE=yield e.pokemonService.getById(e.idE),e.MAX_HPE=e.pokemonE.stats[0].base_stat;let r=0;for(const p of e.pokemon?.moves||[]){if(r>=4)break;e.ataques[r]=yield e.detallesAtaque(p.move.name),r++}let _=0;for(const p of e.pokemonE?.moves||[]){if(_>=4)break;e.ataquesE[_]=yield e.detallesAtaque(p.move.name),_++}const u=new x(e.pokemon?.stats[0].base_stat,e.pokemon?.stats[1].base_stat,e.pokemon?.stats[2].base_stat,e.pokemon?.stats[3].base_stat,e.pokemon?.stats[4].base_stat,e.pokemon?.stats[5].base_stat);e.pokemonBattle=new f(e.pokemon.name,e.ataques,u);const d=new x(e.pokemonE?.stats[0].base_stat,e.pokemonE?.stats[1].base_stat,e.pokemonE?.stats[2].base_stat,e.pokemonE?.stats[3].base_stat,e.pokemonE?.stats[4].base_stat,e.pokemonE?.stats[5].base_stat);e.pokemonBattleEnemy=new f(e.pokemonE.name,e.ataquesE,d)});return function(i){return s.apply(this,arguments)}}())}atacar(e){e&&e.power&&(e.pp--,this.pokemonBattleEnemy.stats.hp=this.pokemonBattleEnemy.stats.hp-this.damage(1,this.pokemonBattle.stats.attack,e.power,this.pokemonBattleEnemy.stats.defense),this.pokemonBattleEnemy.stats.hp<=0&&(console.log("\xa1Has ganado la batalla!"),this.ganas()),this.mensajeAtaque=`\xa1Has atacado con ${e.name} y has infligido ${this.damage(1,this.pokemonBattle.stats.attack,e.power,this.pokemonBattleEnemy.stats.defense)} puntos de da\xf1o!`),this.devolverAtaque()}devolverAtaque(){const e=Math.floor(Math.random()*this.pokemonBattleEnemy.ataques.length);console.log(this.pokemonBattleEnemy.ataques[e].name,this.pokemonBattleEnemy.ataques[e].power),this.pokemonBattle.stats.hp=this.pokemonBattle.stats.hp-this.damage(1,this.pokemonBattleEnemy.stats.attack,this.pokemonBattleEnemy.ataques[e].power,this.pokemonBattleEnemy.stats.defense),this.mensajeAtaqueEnemigo=`\xa1Ha atacado con ${this.pokemonBattleEnemy.ataques[e].name} y has infligido ${this.damage(1,this.pokemonBattleEnemy.stats.attack,this.pokemonBattleEnemy.ataques[e].power,this.pokemonBattleEnemy.stats.defense)} puntos de da\xf1o!`}damage(e,a,s,i){return Math.floor((2*e/5+2)*s*a/i/50)+2}volver(){this.mostrarAtaques=!1}realizarBatalla(){if(this.mostrarAtaques=!0,this.pokemonBattleEnemy.stats.hp<=0)return console.log("\xa1Has ganado la batalla!"),void this.ganas();this.pokemonBattle.stats.hp<=0&&console.log("\xa1Has sido derrotado!")}huir(){this.router.navigate(["/dashboard/battle/"])}ganas(){this.authService.aniadirExp(this.modo,this.user.id).subscribe(e=>{console.log("Esto es lo que me llega de la respuesta",e)},e=>{console.error("Ha habido un error: ",JSON.stringify(e,null,2))})}usarPocion(){}detallesAtaque(e){return this.pokemonService.getByIdMove(e)}calcularPorcentajeVida(e){return 100*e/this.MAX_HP+"%"}calcularPorcentajeVidaE(e){return 100*e/this.MAX_HPE+"%"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(B._),t.Y36(m.gz),t.Y36(m.F0),t.Y36(y.f))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-fight-poke"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["cargando",""],[1,"container"],["terminaBatalla",""],[1,"row"],[1,"col","d-flex","justify-content-center","flex-column","align-items-center"],["alt","",1,"w-50",3,"src"],[4,"ngIf"],["alt","Pokemon Sprite",1,"w-50",3,"src"],[1,"col-2"],[1,"col"],[1,"ataques","m-3","d-flex","flex-wrap","justify-content-between"],[1,"vida-container"],[1,"vida-bar",3,"ngStyle"],["mat-mini-fab","","color","primary",3,"click"],[4,"ngFor","ngForOf"],["class","col-md-6 col-lg-6 d-flex flex-column align-items-center",3,"click",4,"ngIf"],[1,"col-md-6","col-lg-6","d-flex","flex-column","align-items-center",3,"click"],[1,"col","d-flex","flex-column","m-3"],["mat-raised-button","","color","primary",1,"m-3",3,"click"],["mat-raised-button","","color","primary",1,"m-3"],["ganas",""]],template:function(e,a){if(1&e&&(t.YNc(0,I,5,2,"div",0),t.YNc(1,N,2,0,"ng-template",null,1,t.W1O)),2&e){const s=t.MAs(2);t.Q6J("ngIf",a.pokemon&&a.pokemonE)("ngIfElse",s)}},dependencies:[l.sg,l.O5,l.PC,v.Hw,g.lW,g.nh],styles:[".health-bar[_ngcontent-%COMP%]{width:200px;height:20px;background-color:#ddd;border:1px solid #999;border-radius:4px;overflow:hidden}.health-bar-fill[_ngcontent-%COMP%]{height:100%;background-color:#4caf50;transition:width .3s}.vida-container[_ngcontent-%COMP%]{width:100%;height:20px;background-color:#ddd}.vida-bar[_ngcontent-%COMP%]{height:100%;background-color:#4caf50;transition:width .3s}"]}),n})(),Q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-battle-poke-page"]],decls:3,vars:0,consts:[[1,"container"],[1,"row"]],template:function(e,a){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"app-fight-poke"),t.qZA()())},dependencies:[H]}),n})(),S=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[l.ez,v.Ps,g.ot]}),n})();const Y=[{path:"",component:Q}];let O=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[l.ez,S,m.Bz.forChild(Y)]}),n})()}}]);